## 대제목

오늘은 pandas에서 merge를 하는 방법에 대해 학습했다. 


#### pandas DF 다루기

먼저 코드를 보자.

```python
>> df_condition  = df[df["movieCd"]==movieCd & df["load_dt"]==load_dt)].copy() 
```

위 코드는 df 변수로 지정된 pandas DataFrame에서 movieCd와 load_dt가 특정한 조건일 경우인 것만 필터링한 것이다. 마지막의 `.copy()`는 결과와 동일한 DataFrame을 복사한다는 것인데, 오류가 발생할 수 있으므로 복사해서 사용하는 것이 안정적이다. 

```python
>> df_condition["load_dt"] = df_condition["load_dt"].astype("object")
>> df_condition["multiMovieYn"] = df_condition["multiMovieYn"].astype("object")
>> df_condition["repNationCd"] = df_condition["repNationCd"].astype("object")
```

해당 DataFrame은 read_parquet()을 통해 만들어진 것이다. 이 때, parquet을 생성할 때 partition_cols로 지정했던 column은 data type이 categorical로 지정된다. 그런데 categorical은 조작하기 쉽지 않으므로, 조작이 간편한 object 타입(pandas에서 string이 object로 표현된다)으로 data type을 변경해주었다. 

```python
>> df_where['multiMovieYn'] = df_where['multiMovieYn'].fillna('unknown')
>> df_where['repNationCd'] = df_where['repNationCd'].fillna('unknown')
 


### 정리
